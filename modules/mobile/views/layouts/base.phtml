<?php
$auth = Zend_Auth::getInstance();
$controller = Zend_Controller_Front::getInstance()->getRequest()->getControllerName();
?>
<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <?php
    # Title
    echo $this->headTitle();

    # Meta data
    echo $this->headMeta();

    # CSS
    echo $this->headLink()
        ->appendStylesheet($this->baseUrl() . '/css/jquery.mobile-1.1.0.min.css');

    # Javascript
    echo $this->headScript()
        ->appendFile($this->baseUrl() . '/js/jquery-1.7.2.min.js', 'text/javascript')
        ->appendFile($this->baseUrl() . '/js/jquery.mobile-1.1.0.min.js', 'text/javascript')
        ->appendFile($this->baseUrl() . '/js/custom-mobile.js', 'text/javascript');
    ?>
</head>
<body>
<body>
<!-- Home -->
<div data-role="page" id="wjbpage">
    <div data-theme="a" data-role="header">
<?php if ($auth->hasIdentity()) : ?>
        <?php if ($controller != 'index') : ?>
            <a data-rel="back" data-icon="back" class="ui-btn-left" rel="external">Back</a>
        <?php else: ?>
            <a href="/mobile/" data-icon="refresh" class="ui-btn-left" rel="external">Refresh</a>
        <?php endif ?>
<?php endif ?>
        <h3>
            <?php echo $this->headerString ?>
        </h3>
<?php if ($auth->hasIdentity()) : ?>
        <a href="javascript:;" data-icon="search" class="ui-btn-right" onclick="toggleSearchBox()">Search</a>
<?php endif ?>
    </div>
    <div data-role="content" style="padding: 15px">
<?php if ($auth->hasIdentity()) : ?>
        <form id="searchForm" method="post" action="/mobile/search/" data-ajax="false" <?php if (!isset($this->searchQuery)): ?>style="display: none"<?php endif ?>>
            <div data-role="fieldcontain" class="ui-hide-label">
                <input id="fQuery" name="q" value="<?php echo $this->searchQuery ?>" type="search" placeholder="Search" data-mini="true" />
            </div>
</form>
<?php endif ?>
    <div id="contentBox">
            <?php echo $this->layout()->content; ?>
    </div>
    </div>
    <div data-theme="a" data-role="footer" data-position="fixed">
        <?php if ($auth->hasIdentity()) : ?>
        <?php if (Zend_Controller_Front::getInstance()->getRequest()->getControllerName() != 'index') : ?>
            <a href="/mobile/" data-icon="home" class="ui-btn-left" rel="external">Home</a>
            <?php endif ?>
        <?php endif ?>
        <h3>
            The Wicked Net
        </h3>
        <?php if ($auth->hasIdentity()) : ?>
        <?php if (Zend_Controller_Front::getInstance()->getRequest()->getControllerName() != 'index') : ?>
            <a href="/mobile/auth/logout/" data-icon="delete" class="ui-btn-right" rel="external">Logout</a>
            <?php endif ?>
        <?php endif ?>
    </div>
</div>

<script>
    $(document).bind("mobileinit", function(){
        $.extend(  $.mobile , {
            ajaxFormsEnabled: false
        });
    });

</script>
</body>
</html>
